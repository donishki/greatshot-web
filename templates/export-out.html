{% extends "layout.html" %}
{% block title %} - Export output{% endblock %}

{% block content %}
<h2>Export output</h2>

<h2>Sprees</h2>

<script type="text/javascript">
function fillForm(e) {
	parameters=["start","end","client_num"];
	for (i=0;i<parameters.length;i++) {
		$('form #'+parameters[i]).val($(e).parent().attr('data-'+parameters[i]));
	}
}
</script>


{% for player in parser_out.players %}
	{% for spree in player.sprees %}
		<div data-client_num="{{ spree[0]['bAttacker'] }}" data-start="{{ spree[0]['dwTime'] }}" data-end="{{ spree[spree|length - 1]['dwTime'] }}">
			{% for kill in spree %}
				{{ kill.bAttacker }} {{ kill.bTarget }} {{ kill.szTimeString }} {{ kill.szMessage }} {{ kill.dwTime }}<br/>
			{% endfor %}
			<a class="btn btn-default btn-lg" href="#render-form" onclick="fillForm(this);">
				<span style="width:20px" class="glyphicon glyphicon glyphicon-film"></span> Render
			</a>
		</div>
		<br/>{{ spree.interval }}<br/>
	{% endfor %}
{% endfor %}

{% from "form.html" import render_form, render_btn %}
<form method="post" id="render-form" action="/renders" enctype="multipart/form-data" class="form-horizontal panel panel-default">
    <div class="panel-heading" style="margin-bottom:10px">Render parameters</div>
    {{ render_form(cut_form) }}
    {{ render_btn("Render") }}
    <hr/>
    <label class="col-sm-offset-2">
        <sup>*</sup> Client number only needed for ETTV demo to choose POV
    </label>
</form>

<div style="">
	<h3>Hit regions</h3>
	<p>
		Hitregions:
		131 - body or dead body(gibbing)
		130 - head
		0 - target has spawnshield
		132 teammate hit
	</p>
	<table>
		<tr><td>Player</td><td>Hitregion</td><td>Count</td></tr>
	{% for row in parser_out.hits %}
		<tr>
			{% for column in row %}
			<td>{{ column }}</td>
			{% endfor %}
		</tr>
	{% endfor %}
	</table>
</div>

<h2>Raw output</h2>
<pre>
{{ out }}
</pre>
{% endblock %}